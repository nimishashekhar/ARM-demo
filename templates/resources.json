{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "storageAccountType": {
      "type": "string",
      "defaultValue": "Standard_LRS",
      "allowedValues": [
        "Standard_LRS",
        "Standard_GRS",
        "Standard_ZRS",
        "Premium_LRS"
      ],
      "metadata": {
        "description": "Storage Account type"
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Location for all resources."
      }
    },
	"vnetName": {
      "type": "string",
      "defaultValue": "VNet1",
      "metadata": {
        "description": "VNet name"
      }
    },
    "vnetAddressPrefix": {
      "type": "string",
      "defaultValue": "10.0.0.0/16",
      "metadata": {
        "description": "Address prefix"
      }
    },
    "subnet1Prefix": {
      "type": "string",
      "defaultValue": "10.0.0.0/24",
      "metadata": {
        "description": "Subnet 1 Prefix"
      }
    },
    "subnet1Name": {
      "type": "string",
      "defaultValue": "Subnet1",
      "metadata": {
        "description": "Subnet 1 Name"
      }
    },
    "subnet2Prefix": {
      "type": "string",
      "defaultValue": "10.0.1.0/24",
      "metadata": {
        "description": "Subnet 2 Prefix"
      }
    },
    "subnet2Name": {
      "type": "string",
      "defaultValue": "Subnet2",
      "metadata": {
        "description": "Subnet 2 Name"
      }
    }
  },
  "variables": {
    "storageAccountName": "[concat('store', uniquestring(resourceGroup().id))]"
  },
  "resources": [
    {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2019-06-01",
      "name": "[variables('storageAccountName')]",
      "location": "[parameters('location')]",
      "sku": {
        "name": "[parameters('storageAccountType')]"
      },
      "kind": "StorageV2",
      "properties": {}
    },
	{
	  "name": "string",
	  "type": "Microsoft.Network/publicIPAddresses",
	  "apiVersion": "2020-07-01",
	  "location": "[parameters('location')]",
	  "tags": {},
	  "extendedLocation": {
		"name": "string",
		"type": "EdgeZone"
	  },
	  "sku": {
		"name": "string",
		"tier": "string"
	  },
	  "properties": {
		"publicIPAllocationMethod": "string",
		"publicIPAddressVersion": "string",
		"dnsSettings": {
		  "domainNameLabel": "string",
		  "fqdn": "string",
		  "reverseFqdn": "string"
		},
		"ddosSettings": {
		  "ddosCustomPolicy": {
			"id": "string"
		  },
		  "protectionCoverage": "string",
		  "protectedIP": "boolean"
		},
		"ipTags": [
		  {
			"ipTagType": "string",
			"tag": "string"
		  }
		],
		"ipAddress": "string",
		"publicIPPrefix": {
		  "id": "string"
		},
		"idleTimeoutInMinutes": "integer"
	  },
	  "zones": [
		"string"
	  ]
	},
	{
	  "name": "string",
	  "type": "Microsoft.Network/networkSecurityGroups",
	  "apiVersion": "2020-07-01",
	  "location": "[parameters('location')]",
	  "tags": {},
	  "properties": {
		"securityRules": [
		  {
			"id": "string",
			"properties": {
			  "description": "string",
			  "protocol": "string",
			  "sourcePortRange": "string",
			  "destinationPortRange": "string",
			  "sourceAddressPrefix": "string",
			  "sourceAddressPrefixes": [
				"string"
			  ],
			  "sourceApplicationSecurityGroups": [
				{
				  "id": "string",
				  "location": "string",
				  "tags": {},
				  "properties": {}
				}
			  ],
			  "destinationAddressPrefix": "string",
			  "destinationAddressPrefixes": [
				"string"
			  ],
			  "destinationApplicationSecurityGroups": [
				{
				  "id": "string",
				  "location": "string",
				  "tags": {},
				  "properties": {}
				}
			  ],
			  "sourcePortRanges": [
				"string"
			  ],
			  "destinationPortRanges": [
				"string"
			  ],
			  "access": "string",
			  "priority": "integer",
			  "direction": "string"
			},
			"name": "string"
		  }
		]
	  },
	  "resources": []
	},
	{
      "type": "Microsoft.Network/virtualNetworks",
      "apiVersion": "2020-05-01",
      "name": "[parameters('vnetName')]",
      "location": "[parameters('location')]",
      "properties": {
        "addressSpace": {
          "addressPrefixes": [
            "[parameters('vnetAddressPrefix')]"
          ]
        }
      },
      "resources": [
        {
          "type": "subnets",
          "apiVersion": "2020-05-01",
          "location": "[parameters('location')]",
          "name": "[parameters('subnet1Name')]",
          "dependsOn": [
            "[parameters('vnetName')]"
          ],
          "properties": {
            "addressPrefix": "[parameters('subnet1Prefix')]"
          }
        },
        {
          "type": "subnets",
          "apiVersion": "2020-05-01",
          "location": "[parameters('location')]",
          "name": "[parameters('subnet2Name')]",
          "dependsOn": [
            "[parameters('vnetName')]",
            "[parameters('subnet1Name')]"
          ],
          "properties": {
            "addressPrefix": "[parameters('subnet2Prefix')]"
          }
        }
      ]
    },
	{
	  "name": "string",
	  "type": "Microsoft.Network/networkInterfaces",
	  "apiVersion": "2020-07-01",
	  "location": "[parameters('location')]",
	  "tags": {},
	  "extendedLocation": {
		"name": "string",
		"type": "EdgeZone"
	  },
	  "properties": {
		"networkSecurityGroup": {
		  "id": "string",
		  "location": "string",
		  "tags": {},
		  "properties": {
			"securityRules": [
			  {
				"id": "string",
				"properties": {
				  "description": "string",
				  "protocol": "string",
				  "sourcePortRange": "string",
				  "destinationPortRange": "string",
				  "sourceAddressPrefix": "string",
				  "sourceAddressPrefixes": [
					"string"
				  ],
				  "sourceApplicationSecurityGroups": [
					{
					  "id": "string",
					  "location": "string",
					  "tags": {},
					  "properties": {}
					}
				  ],
				  "destinationAddressPrefix": "string",
				  "destinationAddressPrefixes": [
					"string"
				  ],
				  "destinationApplicationSecurityGroups": [
					{
					  "id": "string",
					  "location": "string",
					  "tags": {},
					  "properties": {}
					}
				  ],
				  "sourcePortRanges": [
					"string"
				  ],
				  "destinationPortRanges": [
					"string"
				  ],
				  "access": "string",
				  "priority": "integer",
				  "direction": "string"
				},
				"name": "string"
			  }
			]
		  }
		},
		"ipConfigurations": [
		  {
			"id": "string",
			"properties": {
			  "virtualNetworkTaps": [
				{
				  "id": "string",
				  "location": "string",
				  "tags": {},
				  "properties": {
					"destinationNetworkInterfaceIPConfiguration": "NetworkInterfaceIPConfiguration",
					"destinationLoadBalancerFrontEndIPConfiguration": {
					  "id": "string",
					  "properties": {
						"privateIPAddress": "string",
						"privateIPAllocationMethod": "string",
						"privateIPAddressVersion": "string",
						"subnet": {
						  "id": "string",
						  "properties": {
							"addressPrefix": "string",
							"addressPrefixes": [
							  "string"
							],
							"networkSecurityGroup": {
							  "id": "string",
							  "location": "string",
							  "tags": {},
							  "properties": {
								"securityRules": [
								  {
									"id": "string",
									"properties": {
									  "description": "string",
									  "protocol": "string",
									  "sourcePortRange": "string",
									  "destinationPortRange": "string",
									  "sourceAddressPrefix": "string",
									  "sourceAddressPrefixes": [
										"string"
									  ],
									  "sourceApplicationSecurityGroups": [
										{
										  "id": "string",
										  "location": "string",
										  "tags": {},
										  "properties": {}
										}
									  ],
									  "destinationAddressPrefix": "string",
									  "destinationAddressPrefixes": [
										"string"
									  ],
									  "destinationApplicationSecurityGroups": [
										{
										  "id": "string",
										  "location": "string",
										  "tags": {},
										  "properties": {}
										}
									  ],
									  "sourcePortRanges": [
										"string"
									  ],
									  "destinationPortRanges": [
										"string"
									  ],
									  "access": "string",
									  "priority": "integer",
									  "direction": "string"
									},
									"name": "string"
								  }
								]
							  }
							},
							"routeTable": {
							  "id": "string",
							  "location": "string",
							  "tags": {},
							  "properties": {
								"routes": [
								  {
									"id": "string",
									"properties": {
									  "addressPrefix": "string",
									  "nextHopType": "string",
									  "nextHopIpAddress": "string"
									},
									"name": "string"
								  }
								],
								"disableBgpRoutePropagation": "boolean"
							  }
							},
							"natGateway": {
							  "id": "string"
							},
							"serviceEndpoints": [
							  {
								"service": "string",
								"locations": [
								  "string"
								]
							  }
							],
							"serviceEndpointPolicies": [
							  {
								"id": "string",
								"location": "string",
								"tags": {},
								"properties": {
								  "serviceEndpointPolicyDefinitions": [
									{
									  "id": "string",
									  "properties": {
										"description": "string",
										"service": "string",
										"serviceResources": [
										  "string"
										]
									  },
									  "name": "string"
									}
								  ]
								}
							  }
							],
							"ipAllocations": [
							  {
								"id": "string"
							  }
							],
							"delegations": [
							  {
								"id": "string",
								"properties": {
								  "serviceName": "string"
								},
								"name": "string"
							  }
							],
							"privateEndpointNetworkPolicies": "string",
							"privateLinkServiceNetworkPolicies": "string"
						  },
						  "name": "string"
						},
						"publicIPAddress": {
						  "id": "string",
						  "location": "string",
						  "tags": {},
						  "extendedLocation": {
							"name": "string",
							"type": "EdgeZone"
						  },
						  "sku": {
							"name": "string",
							"tier": "string"
						  },
						  "properties": {
							"publicIPAllocationMethod": "string",
							"publicIPAddressVersion": "string",
							"dnsSettings": {
							  "domainNameLabel": "string",
							  "fqdn": "string",
							  "reverseFqdn": "string"
							},
							"ddosSettings": {
							  "ddosCustomPolicy": {
								"id": "string"
							  },
							  "protectionCoverage": "string",
							  "protectedIP": "boolean"
							},
							"ipTags": [
							  {
								"ipTagType": "string",
								"tag": "string"
							  }
							],
							"ipAddress": "string",
							"publicIPPrefix": {
							  "id": "string"
							},
							"idleTimeoutInMinutes": "integer"
						  },
						  "zones": [
							"string"
						  ]
						},
						"publicIPPrefix": {
						  "id": "string"
						}
					  },
					  "name": "string",
					  "zones": [
						"string"
					  ]
					},
					"destinationPort": "integer"
				  }
				}
			  ],
			  "applicationGatewayBackendAddressPools": [
				{
				  "id": "string",
				  "properties": {
					"backendAddresses": [
					  {
						"fqdn": "string",
						"ipAddress": "string"
					  }
					]
				  },
				  "name": "string"
				}
			  ],
			  "loadBalancerBackendAddressPools": [
				{
				  "id": "string",
				  "properties": {
					"loadBalancerBackendAddresses": [
					  {
						"properties": {
						  "virtualNetwork": {
							"id": "string"
						  },
						  "ipAddress": "string",
						  "loadBalancerFrontendIPConfiguration": {
							"id": "string"
						  }
						},
						"name": "string"
					  }
					]
				  },
				  "name": "string"
				}
			  ],
			  "loadBalancerInboundNatRules": [
				{
				  "id": "string",
				  "properties": {
					"frontendIPConfiguration": {
					  "id": "string"
					},
					"protocol": "string",
					"frontendPort": "integer",
					"backendPort": "integer",
					"idleTimeoutInMinutes": "integer",
					"enableFloatingIP": "boolean",
					"enableTcpReset": "boolean"
				  },
				  "name": "string"
				}
			  ],
			  "privateIPAddress": "string",
			  "privateIPAllocationMethod": "string",
			  "privateIPAddressVersion": "string",
			  "subnet": {
				"id": "string",
				"properties": {
				  "addressPrefix": "string",
				  "addressPrefixes": [
					"string"
				  ],
				  "networkSecurityGroup": {
					"id": "string",
					"location": "string",
					"tags": {},
					"properties": {
					  "securityRules": [
						{
						  "id": "string",
						  "properties": {
							"description": "string",
							"protocol": "string",
							"sourcePortRange": "string",
							"destinationPortRange": "string",
							"sourceAddressPrefix": "string",
							"sourceAddressPrefixes": [
							  "string"
							],
							"sourceApplicationSecurityGroups": [
							  {
								"id": "string",
								"location": "string",
								"tags": {},
								"properties": {}
							  }
							],
							"destinationAddressPrefix": "string",
							"destinationAddressPrefixes": [
							  "string"
							],
							"destinationApplicationSecurityGroups": [
							  {
								"id": "string",
								"location": "string",
								"tags": {},
								"properties": {}
							  }
							],
							"sourcePortRanges": [
							  "string"
							],
							"destinationPortRanges": [
							  "string"
							],
							"access": "string",
							"priority": "integer",
							"direction": "string"
						  },
						  "name": "string"
						}
					  ]
					}
				  },
				  "routeTable": {
					"id": "string",
					"location": "string",
					"tags": {},
					"properties": {
					  "routes": [
						{
						  "id": "string",
						  "properties": {
							"addressPrefix": "string",
							"nextHopType": "string",
							"nextHopIpAddress": "string"
						  },
						  "name": "string"
						}
					  ],
					  "disableBgpRoutePropagation": "boolean"
					}
				  },
				  "natGateway": {
					"id": "string"
				  },
				  "serviceEndpoints": [
					{
					  "service": "string",
					  "locations": [
						"string"
					  ]
					}
				  ],
				  "serviceEndpointPolicies": [
					{
					  "id": "string",
					  "location": "string",
					  "tags": {},
					  "properties": {
						"serviceEndpointPolicyDefinitions": [
						  {
							"id": "string",
							"properties": {
							  "description": "string",
							  "service": "string",
							  "serviceResources": [
								"string"
							  ]
							},
							"name": "string"
						  }
						]
					  }
					}
				  ],
				  "ipAllocations": [
					{
					  "id": "string"
					}
				  ],
				  "delegations": [
					{
					  "id": "string",
					  "properties": {
						"serviceName": "string"
					  },
					  "name": "string"
					}
				  ],
				  "privateEndpointNetworkPolicies": "string",
				  "privateLinkServiceNetworkPolicies": "string"
				},
				"name": "string"
			  },
			  "primary": "boolean",
			  "publicIPAddress": {
				"id": "string",
				"location": "string",
				"tags": {},
				"extendedLocation": {
				  "name": "string",
				  "type": "EdgeZone"
				},
				"sku": {
				  "name": "string",
				  "tier": "string"
				},
				"properties": {
				  "publicIPAllocationMethod": "string",
				  "publicIPAddressVersion": "string",
				  "dnsSettings": {
					"domainNameLabel": "string",
					"fqdn": "string",
					"reverseFqdn": "string"
				  },
				  "ddosSettings": {
					"ddosCustomPolicy": {
					  "id": "string"
					},
					"protectionCoverage": "string",
					"protectedIP": "boolean"
				  },
				  "ipTags": [
					{
					  "ipTagType": "string",
					  "tag": "string"
					}
				  ],
				  "ipAddress": "string",
				  "publicIPPrefix": {
					"id": "string"
				  },
				  "idleTimeoutInMinutes": "integer"
				},
				"zones": [
				  "string"
				]
			  },
			  "applicationSecurityGroups": [
				{
				  "id": "string",
				  "location": "string",
				  "tags": {},
				  "properties": {}
				}
			  ]
			},
			"name": "string"
		  }
		],
		"dnsSettings": {
		  "dnsServers": [
			"string"
		  ],
		  "internalDnsNameLabel": "string"
		},
		"enableAcceleratedNetworking": "boolean",
		"enableIPForwarding": "boolean"
	  },
	  "resources": []
	}
  ]
}
